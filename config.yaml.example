# Weave MCP Server Configuration Example
# Copy this file to config.yaml and update with your values

---
# Collection Schemas Directory
# Directory containing schema YAML files (one schema per file)
# Schemas defined inline in databases.schemas take precedence over directory schemas
schemas_dir: ./schemas

# Database Configuration
databases:
  # Default database type to use
  # Options: weaviate-cloud, weaviate-local, supabase, qdrant, neo4j, pinecone,
  #          opensearch, elasticsearch, mongodb, milvus, chroma, mock
  default: ${VECTOR_DB_TYPE:-weaviate-cloud}
  
  # Available vector databases
  vector_databases:
    
    # Weaviate Cloud (Paid Service)
    # Requires: WEAVIATE_URL, WEAVIATE_API_KEY, OPENAI_API_KEY
    # Embedding Models: Configure via 'vectorizer' parameter in create_collection
    #   - text2vec-openai (default, auto-selects best model)
    #   - text-embedding-3-small (fastest, cost-effective)
    #   - text-embedding-3-large (highest quality)
    #   - text-embedding-ada-002 (legacy, still supported)
    - name: weaviate-cloud
      type: weaviate-cloud
      url: ${WEAVIATE_URL}                    # Your Weaviate Cloud URL
      api_key: ${WEAVIATE_API_KEY}           # Your Weaviate Cloud API key
      openai_api_key: ${OPENAI_API_KEY}      # OpenAI API key for embeddings
      collections:
        - name: ${WEAVIATE_COLLECTION:-WeaveDocs}
          type: text
          description: Main text documents collection
        - name: ${WEAVIATE_COLLECTION_IMAGES:-WeaveImages}
          type: image
          description: Image documents collection
        - name: ${WEAVIATE_COLLECTION_TEST:-WeaveDocs_test}
          type: text
          description: Test text documents collection

    # Weaviate Local (Open Source)
    # Requires: Local Weaviate instance running on localhost:8080
    - name: weaviate-local
      type: weaviate-local
      url: http://localhost:8080              # Local Weaviate instance
      collections:
        - name: ${WEAVIATE_COLLECTION:-WeaveDocs}
          type: text
          description: Main text documents collection
        - name: ${WEAVIATE_COLLECTION_IMAGES:-WeaveImages}
          type: image
          description: Image documents collection

    # Supabase with pgvector (Paid/Free Tier Available)
    # Requires: SUPABASE_URL, SUPABASE_DATABASE_URL, SUPABASE_SERVICE_KEY, OPENAI_API_KEY
    # Embedding Models: Uses OpenAI client for embedding generation
    #   - text-embedding-3-small (default, 1536 dimensions)
    #   - text-embedding-3-large (3072 dimensions)
    #   - text-embedding-ada-002 (1536 dimensions)
    - name: supabase
      type: supabase
      url: ${SUPABASE_URL}                    # Supabase project URL (https://xxx.supabase.co)
      database_url: ${SUPABASE_DATABASE_URL}  # PostgreSQL connection string
      database_key: ${SUPABASE_SERVICE_KEY}   # Service role key (not anon key)
      openai_api_key: ${OPENAI_API_KEY}       # Required for embeddings
      collections:
        - name: ${SUPABASE_COLLECTION:-WeaveDocs}
          type: text
          description: Supabase text collection
        - name: ${SUPABASE_COLLECTION_IMAGES:-WeaveImages}
          type: image
          description: Supabase image collection

    # MongoDB Atlas Vector Search (Paid/Free Tier Available)
    # Requires: MONGODB_URI, MONGODB_DATABASE, OPENAI_API_KEY
    # Embedding Models: Uses OpenAI client for automatic embedding generation
    #   - text-embedding-3-small (default, 1536 dimensions)
    #   - text-embedding-3-large (3072 dimensions)
    #   - text-embedding-ada-002 (1536 dimensions)
    - name: mongodb
      type: mongodb
      url: ${MONGODB_URI}                     # MongoDB connection string
      database_url: ${MONGODB_DATABASE}       # Database name
      openai_api_key: ${OPENAI_API_KEY}       # Required for embeddings
      collections:
        - name: ${MONGODB_COLLECTION:-WeaveDocs}
          type: text
          description: MongoDB text collection
        - name: ${MONGODB_COLLECTION_IMAGES:-WeaveImages}
          type: image
          description: MongoDB image collection

    # Milvus Vector Database (Open Source/Cloud)
    # Requires: MILVUS_HOST, MILVUS_PORT, OPENAI_API_KEY
    # Embedding Models: Uses OpenAI client for embedding generation
    #   - text-embedding-3-small (default, 1536 dimensions)
    #   - text-embedding-3-large (3072 dimensions)
    #   - text-embedding-ada-002 (1536 dimensions)
    - name: milvus
      type: milvus
      url: ${MILVUS_HOST}:${MILVUS_PORT}      # Milvus server address
      api_key: ${MILVUS_API_KEY}              # Optional: Milvus Cloud API key
      openai_api_key: ${OPENAI_API_KEY}       # Required for embeddings
      collections:
        - name: ${MILVUS_COLLECTION:-WeaveDocs}
          type: text
          description: Milvus text collection
        - name: ${MILVUS_COLLECTION_IMAGES:-WeaveImages}
          type: image
          description: Milvus image collection

    # Chroma Vector Database (Open Source/Cloud)
    # Requires: CHROMA_URL, OPENAI_API_KEY
    # Note: Not supported on Windows due to CGO dependencies
    # Embedding Models: Uses OpenAI client for embedding generation
    #   - text-embedding-3-small (default, 1536 dimensions)
    #   - text-embedding-3-large (3072 dimensions)
    #   - text-embedding-ada-002 (1536 dimensions)
    - name: chroma
      type: chroma
      url: ${CHROMA_URL}                      # Chroma server URL
      api_key: ${CHROMA_API_KEY}              # Optional: Chroma Cloud API key
      openai_api_key: ${OPENAI_API_KEY}       # Required for embeddings
      collections:
        - name: ${CHROMA_COLLECTION:-WeaveDocs}
          type: text
          description: Chroma text collection
        - name: ${CHROMA_COLLECTION_IMAGES:-WeaveImages}
          type: image
          description: Chroma image collection

    # Qdrant Vector Database (Open Source/Cloud)
    # Requires: QDRANT_URL, OPENAI_API_KEY
    # Embedding Models: Uses OpenAI client for embedding generation
    #   - text-embedding-3-small (default, 1536 dimensions)
    #   - text-embedding-3-large (3072 dimensions)
    #   - text-embedding-ada-002 (1536 dimensions)
    - name: qdrant
      type: qdrant
      url: ${QDRANT_URL}                      # Qdrant server URL (http://localhost:6333 or cloud)
      api_key: ${QDRANT_API_KEY}              # Optional: Qdrant Cloud API key
      openai_api_key: ${OPENAI_API_KEY}       # Required for embeddings
      collections:
        - name: ${QDRANT_COLLECTION:-WeaveDocs}
          type: text
          description: Qdrant text collection
        - name: ${QDRANT_COLLECTION_IMAGES:-WeaveImages}
          type: image
          description: Qdrant image collection

    # Neo4j Vector Database (Graph Database with Vector Search)
    # Requires: NEO4J_URI, NEO4J_USERNAME, NEO4J_PASSWORD, OPENAI_API_KEY
    # Embedding Models: Uses OpenAI client for embedding generation
    #   - text-embedding-3-small (default, 1536 dimensions)
    #   - text-embedding-3-large (3072 dimensions)
    #   - text-embedding-ada-002 (1536 dimensions)
    - name: neo4j
      type: neo4j
      url: ${NEO4J_URI}                       # Neo4j connection URI (bolt://localhost:7687 or neo4j+s://...)
      api_key: ${NEO4J_USERNAME}:${NEO4J_PASSWORD}  # Username:Password format
      openai_api_key: ${OPENAI_API_KEY}       # Required for embeddings
      collections:
        - name: ${NEO4J_COLLECTION:-WeaveDocs}
          type: text
          description: Neo4j text collection
        - name: ${NEO4J_COLLECTION_IMAGES:-WeaveImages}
          type: image
          description: Neo4j image collection

    # Pinecone Vector Database (Managed Cloud Service)
    # Requires: PINECONE_API_KEY, PINECONE_ENVIRONMENT, OPENAI_API_KEY
    # Note: Cloud-only service, no local deployment
    # Embedding Models: Uses OpenAI client for embedding generation
    #   - text-embedding-3-small (default, 1536 dimensions)
    #   - text-embedding-3-large (3072 dimensions)
    #   - text-embedding-ada-002 (1536 dimensions)
    - name: pinecone
      type: pinecone
      api_key: ${PINECONE_API_KEY}            # Pinecone API key
      database_url: ${PINECONE_ENVIRONMENT}   # Pinecone environment (e.g., us-east1-gcp)
      openai_api_key: ${OPENAI_API_KEY}       # Required for embeddings
      collections:
        - name: ${PINECONE_COLLECTION:-WeaveDocs}
          type: text
          description: Pinecone text collection
        - name: ${PINECONE_COLLECTION_IMAGES:-WeaveImages}
          type: image
          description: Pinecone image collection

    # OpenSearch Vector Database (Open Source/AWS Managed) - BETA
    # Requires: OPENSEARCH_URL, OPENAI_API_KEY
    # Note: Beta status in weave-cli v0.8.2, requires 2GB+ RAM
    # Embedding Models: Uses OpenAI client for embedding generation
    #   - text-embedding-3-small (default, 1536 dimensions)
    #   - text-embedding-3-large (3072 dimensions)
    #   - text-embedding-ada-002 (1536 dimensions)
    - name: opensearch
      type: opensearch
      url: ${OPENSEARCH_URL}                  # OpenSearch URL (http://localhost:9200 or AWS endpoint)
      api_key: ${OPENSEARCH_USERNAME}:${OPENSEARCH_PASSWORD}  # Username:Password format
      openai_api_key: ${OPENAI_API_KEY}       # Required for embeddings
      collections:
        - name: ${OPENSEARCH_COLLECTION:-WeaveDocs}
          type: text
          description: OpenSearch text collection
        - name: ${OPENSEARCH_COLLECTION_IMAGES:-WeaveImages}
          type: image
          description: OpenSearch image collection

    # Elasticsearch Vector Database (Elastic Cloud/Self-Hosted) - BETA
    # Requires: ELASTICSEARCH_URL, ELASTICSEARCH_API_KEY, OPENAI_API_KEY
    # Note: Beta status in weave-cli v0.8.2, requires 2GB+ RAM
    # Embedding Models: Uses OpenAI client for embedding generation
    #   - text-embedding-3-small (default, 1536 dimensions)
    #   - text-embedding-3-large (3072 dimensions)
    #   - text-embedding-ada-002 (1536 dimensions)
    - name: elasticsearch
      type: elasticsearch
      url: ${ELASTICSEARCH_URL}               # Elasticsearch URL (http://localhost:9200 or cloud)
      api_key: ${ELASTICSEARCH_API_KEY}       # API key or username:password
      openai_api_key: ${OPENAI_API_KEY}       # Required for embeddings
      collections:
        - name: ${ELASTICSEARCH_COLLECTION:-WeaveDocs}
          type: text
          description: Elasticsearch text collection
        - name: ${ELASTICSEARCH_COLLECTION_IMAGES:-WeaveImages}
          type: image
          description: Elasticsearch image collection

    # Mock Database (For Testing)
    # No external dependencies required
    - name: mock
      type: mock
      enabled: true
      simulate_embeddings: true              # Simulate embedding generation
      embedding_dimension: 384               # Embedding vector dimension
      collections:
        - name: WeaveDocs
          type: text
          description: Mock text documents collection
        - name: WeaveImages
          type: image
          description: Mock image documents collection

  # Collection Schemas (inline)
  # Define named schemas inline that can be used to create collections
  # Use: weave collection create MyCollection --schema RagMeDocs
  # Note: Inline schemas take precedence over schemas in schemas_dir
  schemas:
    # Text document schema optimized for RAG (Retrieval-Augmented Generation)
    - name: RagMeDocs
      schema:
        class: RagMeDocs
        vectorizer: text2vec-weaviate
        properties:
          - name: url
            datatype:
              - text
            description: the source URL of the webpage
          - name: text
            datatype:
              - text
            description: the content of the webpage
          - name: metadata
            datatype:
              - text
            description: additional metadata in JSON format
      metadata:
        id:
          type: string
        metadata:
          type: string
        text:
          type: string
        url:
          type: string

    # Image document schema optimized for RAG
    - name: RagMeImages
      schema:
        class: RagMeImages
        vectorizer: text2vec-weaviate
        properties:
          - name: url
            datatype:
              - text
            description: the source URL or filename of the image
          - name: image
            datatype:
              - text
            description: the image reference (truncated base64 or URL)
          - name: metadata
            datatype:
              - text
            description: additional metadata in JSON format
          - name: image_data
            datatype:
              - text
            description: full image data or reference
      metadata:
        id:
          type: string
        image:
          type: string
        image_data:
          type: string
        metadata:
          type: string
        url:
          type: string

# Environment Variables Reference:
# VECTOR_DB_TYPE: Database type (weaviate-cloud, weaviate-local, supabase,
#                 qdrant, neo4j, pinecone, opensearch, elasticsearch,
#                 mongodb, milvus, chroma, mock)
#
# Weaviate Configuration:
# WEAVIATE_URL: Your Weaviate Cloud URL
# WEAVIATE_API_KEY: Your Weaviate Cloud API key
# WEAVIATE_COLLECTION: Main text collection name
# WEAVIATE_COLLECTION_IMAGES: Image collection name
# WEAVIATE_COLLECTION_TEST: Test collection name
#
# Supabase Configuration:
# SUPABASE_URL: Supabase project URL (https://xxx.supabase.co)
# SUPABASE_DATABASE_URL: PostgreSQL connection string
# SUPABASE_SERVICE_KEY: Supabase service role key (not anon key)
# SUPABASE_COLLECTION: Main text collection name
# SUPABASE_COLLECTION_IMAGES: Image collection name
#
# MongoDB Configuration:
# MONGODB_URI: MongoDB connection string (mongodb+srv://...)
# MONGODB_DATABASE: Database name
# MONGODB_COLLECTION: Main text collection name
# MONGODB_COLLECTION_IMAGES: Image collection name
#
# Milvus Configuration:
# MILVUS_HOST: Milvus server host (localhost or cloud endpoint)
# MILVUS_PORT: Milvus server port (default: 19530)
# MILVUS_API_KEY: Optional Milvus Cloud API key
# MILVUS_COLLECTION: Main text collection name
# MILVUS_COLLECTION_IMAGES: Image collection name
#
# Chroma Configuration:
# CHROMA_URL: Chroma server URL (http://localhost:8000 or cloud endpoint)
# CHROMA_API_KEY: Optional Chroma Cloud API key
# CHROMA_COLLECTION: Main text collection name
# CHROMA_COLLECTION_IMAGES: Image collection name
#
# Qdrant Configuration:
# QDRANT_URL: Qdrant server URL (http://localhost:6333 or cloud endpoint)
# QDRANT_API_KEY: Optional Qdrant Cloud API key
# QDRANT_COLLECTION: Main text collection name
# QDRANT_COLLECTION_IMAGES: Image collection name
#
# Neo4j Configuration:
# NEO4J_URI: Neo4j connection URI (bolt://localhost:7687 or neo4j+s://...)
# NEO4J_USERNAME: Neo4j username
# NEO4J_PASSWORD: Neo4j password
# NEO4J_COLLECTION: Main text collection name
# NEO4J_COLLECTION_IMAGES: Image collection name
#
# Pinecone Configuration:
# PINECONE_API_KEY: Pinecone API key
# PINECONE_ENVIRONMENT: Pinecone environment (e.g., us-east1-gcp)
# PINECONE_COLLECTION: Main text collection name
# PINECONE_COLLECTION_IMAGES: Image collection name
#
# OpenSearch Configuration (Beta):
# OPENSEARCH_URL: OpenSearch URL (http://localhost:9200 or AWS endpoint)
# OPENSEARCH_USERNAME: OpenSearch username
# OPENSEARCH_PASSWORD: OpenSearch password
# OPENSEARCH_COLLECTION: Main text collection name
# OPENSEARCH_COLLECTION_IMAGES: Image collection name
#
# Elasticsearch Configuration (Beta):
# ELASTICSEARCH_URL: Elasticsearch URL (http://localhost:9200 or cloud)
# ELASTICSEARCH_API_KEY: Elasticsearch API key or username:password
# ELASTICSEARCH_COLLECTION: Main text collection name
# ELASTICSEARCH_COLLECTION_IMAGES: Image collection name
#
# Embedding Configuration (Required for all vector databases except mock):
# OPENAI_API_KEY: OpenAI API key for embedding generation
#
# Embedding Models (configured via 'vectorizer' in create_collection tool):
#   - text2vec-openai: Default for Weaviate (auto-selects best model)
#   - text-embedding-3-small: Fast, cost-effective (1536 dims)
#   - text-embedding-3-large: Highest quality (3072 dims)
#   - text-embedding-ada-002: Legacy model (1536 dims)